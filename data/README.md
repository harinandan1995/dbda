# Data Generation from Vector files
This module contains code to convert vector files which are generated by the algorithm in [paper](http://art-programmer.github.io/floorplan-transformation/paper.pdf) into image masks.


[Raster-to-Vector: Revisiting Floorplan Transformation ](http://art-programmer.github.io/floorplan-transformation/paper.pdf)

It accepts vector files as input and can generate three kind of outputs
1. tfrecords (To be implemented)
2. h5py
3. png (image)

tfrecords and h5py contain masks and segmenatation images for walls, windows, doors, rooms, corners, bounding.
1. Walls
     * keys: wall_mask, wall_seg
     * Channels in mask: 1
2. Doors
    * keys: door_mask, door_seg
    * Channels in mask: 1
3. Windows
    * keys: window_mask, window_seg
    * Channels in mask: 1
4. Rooms
    * keys: room_mask, room_seg
    * Channels in mask: 11
    * Default Map:
    ```
    {
        'living_room': 1, 'kitchen': 2, 'bedroom': 3,
        'bathroom': 4, 'restroom': 4, 'washing_room': 4,
        'office': 5, 'closet': 6, 'balcony': 7,
        'corridor': 8, 'dining_room': 9, 'laundry_room': 10,
        'PS': 11
    }
    ```
5. Corners
    * keys: corner_mask, corner_seg
    * Channels in mask: 13
    * Default Map: 
        ```
        * 0 - 3: I-Shape
        * 4 - 7: L-Shape
        * 8 - 11: T-Shape
        * 12: X-Shape
        ```    
6. Bounding
    * keys: bounding_mask, bounding_seg
    * Channels in mask: 1
    * Mask: 1 where the floor is present 0 everywhere else

png contain only segmentation images

PS: The segmentation images have random colors for every transformation

## Usage

To successfully run the code you need the following packages installed
1. tensorflow
2. numpy
3. opencv-python
4. scikit-image

The **VectorToImageTransformer** contains all important logic to transform vector to masks and images. 
This need a **TransformerConfig** in which 
* Input directory
* Output directory
* Output format (allowed values: tfrecord, h5, png)
* Output image dimensions
* Thickness of the wall

are stored which are later used for conversion


For the usage of **VectorToImageTransformer** please check data/main.py 
 
To run the module use the following command

```
    python3 data/main.py 
```


## Data

You can download the vector files [here](https://drive.google.com/file/d/1Ltn5kzzwhvXz6EStI98Zagfq-mI2pf0m/view)

You can download the generated images/masks [here](https://drive.google.com/open?id=1D-BnMzxvhP09n2JiiRD7UsITK63EegJp)